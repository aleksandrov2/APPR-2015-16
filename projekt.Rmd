---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Patrik Gorše"
output:
  pdf_document:
    latex_engine: xelatex
    includes:
      in_header: lib/styles.sty
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

Izbral sem si temo `Dolgovi in primankljaji držav v Evropski uniji`. V svojem poročilu bom analiziral stopnjo zadolženosti držav evropske unije in njihove deficite v letih od 2006 do 2014. Preveril bom kako je naraščala zadolženost držav v evropi in ali morda obstaja kakšna korelacija med dolgom in deficitom. Primerjal bom posamezne države evropske unije in poskusil ugotoviti ali so problematične vse ali obstaja samo neka skupina članic, ki ne vzdržujejo proračunske discipline. Ker je zadnja leta veliko govora tudi o Maastrichskih kriterijih in o tem kako imamo prevelike stopnje zadolženosti, bom na koncu primerjal evropo z drugima dvema najbolj razvitima državama Japonsko in ZDA.
Nasploh je to zelo pomembna tema, saj bodo odločitve politikov in ekonomistov, kakšna naj bo naša strategija pri zadolževanju, uplivale na vsakdanje življenje vseh nas. Na eni strani so nekateri ekonomisti prepričani, da je treba vzdrževati strogo proračunsko disciplino, torej porabiti toliko kolikor država pobere z davki. Ostali pa verjamejo, da je proračunski primakljaj nujen, če hočemo preprečiti ponoven padec v recesijo.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Podatke za prvi dve tabeli sem uvozil iz spletne strani OECD. Tam sem izbral samo podatke evropskih držav, potem pa sem uvozil cvs datoteki na računalnik. Tabelo, ki prikazuje tudi dolg ZDA in Japonske v letih 2007, 2010 in 2011 v primerjavi z evropskimi državami, pa sem kot HTML datoteko uvozil iz Wikipedije. 
Prva tabela prikazuje dolg evropskih držav, druga deficit teh držav in tretja prikazuje dolg ZDA in Japonske v primerjavi z evropskim.

Povezavi za tabele:

- https://data.oecd.org/gga/general-government-debt.htm
- https://en.wikipedia.org/wiki/National_debt_of_the_United_States



Spodaj so prikazani stolpci neobdelanih tabel, ki sem jih uvozil.


Prva tabela:

- LOCATION (ime države)
- INDICATOR (dolg države)
- SUBJECT 
- MEASURE (merimo v BDP na prebivalca)
- FREQUENCY
- TIME (leto)
- VALUE (višina zadolženosti)
- Flag Codes

Druga tabela:

- LOCATION (ime države)
- INDICATOR (deficit države)
- SUBJECT 
- MEASURE (merimo v BDP na prebivalca)
- FREQUENCY
- TIME (leto)
- VALUE (višina deficita)
- Flag Codes

Tretja tabela:

- Entity (ime države)
- 2007 (pokaže višino zadolženosti države leta 2007)
- 2010 (pokaže višino zadolženosti države leta 2010)
- 2011 (pokaže višino zadolženosti države leta 2011)


V prvih dveh tabelah sem nepotrebne stolpce izbrisal in preostalim stolpcem spremenil imena v slovenski jezik. Dobil sem tabeli, ki imata na začetku stolpec `Drzava`, potem sledi stolpec `Cas` in na koncu ima prva tabela stolpec `Dolg`, druga pa `Deficit`. 


```{r podatki1, echo=FALSE}
kable(head(podatki1))
```

Tretja tabela, ki je bila uvožena v HTML obliki, vsebuje podatke o zadolženosti ZDA, Japonske, Velike Britanije, večjih evropskih držav in povprečja EU. Naredil sem 3 podtabele, kjer vsaka prikazuje zadolženost držav v letih 2007, 2010 in 2011, vendar sem odstranil vrstice z odvečnimi državami, tako da so ostale samo še evropske države, ZDA in Japonska.


```{r tabela_3, echo=FALSE}
kable(head(tabela_3))
```

Iz prvih dveh tabel sem ustvaril številne druge podtabele, kjer je po posameznih državah prikazan dolg/deficit v določenem letu.

```{r dolgovi_2014, echo=FALSE}
kable(head(dolgovi_2014))
```


***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```


Na teh dveh grafih lahko tako vidimo kako je zadolženost evropskih držav leta 2006 narasla do leta 2014.

```{r graf1, echo=FALSE, warning=FALSE, fig.cap='Ta graf prikazuje dolg v letu 2006', fig.align='center'}
print(prvi_graf)
```

```{r graf2, echo=FALSE, warning=FALSE, fig.cap='Ta graf prikazuje dolg v letu 2014', fig.align='center'}
print(drugi_graf)
```

Ta graf prav tako prikazuje zadolženost evropskih držav leta 2014, vendar sem tukaj vsako državo aproksimiral s piko in njena velikost ponazarja dolg države. Prav tako je na grafu z rdečo črto označena povprečna zadolženost. 

```{r graf3, echo=FALSE, warning=FALSE, fig.cap='Ta graf prikazuje dolg v letu 2014', fig.align='center'}
print(tretji_graf)
```


Na naslednjih dveh grafih lahko vidimo kakšen deficit so imele države v letu 2006 in 2014. Opazimo lahko, da so države v letu 2014 imele večje težave pri doseganju uravnoteženega proračuna. 

```{r graf4, echo=FALSE, warning=FALSE, fig.cap='Ta graf prikazuje deficit v letu 2006', fig.align='center'}
print(cetrti_graf)
```

```{r graf5, echo=FALSE, warning=FALSE, fig.cap='Ta graf prikazuje deficit v letu 2014', fig.align='center'}
print(peti_graf)
```

Kot vidimo sta zadolženost držav in število tistih, ki so imele primankljaj skozi čas naraščala. Vendar pa zaskrbljujoče narašča tudi število držav z dolgom, ki presega 100% BDP. Če sta bili leta 2006 samo dve taki državi, jih je bilo leta 2014 že devet, kar se vidi iz teh dveh grafov. 

```{r graf6, echo=FALSE, warning=FALSE, fig.cap='Drzave z dolgom vecjim od 100% BDP leta 2006', fig.align='center'}
print(sesti_graf)
```

```{r graf7, echo=FALSE, warning=FALSE, fig.cap='Drzave z dolgom vecjim od 100% BDP leta 2014', fig.align='center'}
print(sedmi_graf)
```

Sedaj si poglejmo kako je naraščal dolg posameznih držav skozi čas. Še posebej sem pod drobnogled vzel Slovenijo. Podatki kažejo, da smo se odrezali precej slabo, saj se je naša zadolženost v 9 letih povečala za 60% in malo je držav, ki bi se zadolževale s tako hitrostjo. To nas postavi vštric z državami kot so Portugalska, Grčija, Irska in Velika Britanija, od katerih so prve tri znane kot bolnice evrope. Prav zato je sedaj toliko bolj razumljivo zakaj so bile pred leti napovedi, da bo v našo državo prišla trojka, saj smo se zadolževali z rekordno hitrostjo. 

Prvi graf kaže hitrost zadolževanja Slovenije, medtem ko drugi graf kaže hitrost zadolževanja Madžarske, kar je hitrost s katero se je zadolževala večina drugih evropskih držav. 

```{r graf8, echo=FALSE, warning=FALSE, fig.cap='Hitrost zadolzevanja Slovenije', fig.align='center'}
print(osmi_graf)
```

```{r graf9, echo=FALSE, warning=FALSE, fig.cap='Hitrost zadolževanja Madzarske', fig.align='center'}
print(deveti_graf)
```

Analizo evroobmočja sem zaključil z grafom, ki ima na abscisni osi podano zadolženost države, na ordinati pa deficit tistega leta. Vsaka država je aproksimirana s svojo točko, velikost točke pa je določena z enačbo `size = Dolg-10*Deficit`. Večje kot je število, slabše se je ta država odrezala. Na grafu sem s črno črto označil mejo uravnoteženega proračuna, torej takrat ko ima država proračunski presežek in z rdečo črto Maastrichtsko določilo, da deficit države ne sme pasti pod -3% BDP letno.

Prvi graf prikazuje razporeditev držav v leta 2006, drugi pa v letu 2014. Zanimivo je to, da se vidi korelacija med zadolženostjo in primankljajem. Države so razporejene približno v diagonalni črti. Zdi se, da večji javni dolg pomeni tudi večji deficit.  


```{r graf10, echo=FALSE, warning=FALSE, fig.cap='Razporeditev evroopskih drzav leta 2006', fig.align='center'}
print(deseti_graf)
```

```{r graf11, echo=FALSE, warning=FALSE, fig.cap='Razporeditev evroopskih drzav leta 2014', fig.align='center'}
print(enajsti_graf)
```


 Zadnji dve državi imata vse ključne parametre zelo podobne evropi, torej stopnja razvitosti, tehnologija, življenski standard... Vendar ko primerjamo njuni stopnji zadolženosti vidimo, da je Japonska najbolj zadolžena od vseh, za neverjetnih 204% BDP, medtem ko je ZDA prav tako bolj zadolžena od večine evropskih držav. 

Graf prikazuje zadolženost evropskih držav, Japonske in ZDA v letu 2011.


```{r graf12, echo=FALSE, warning=FALSE, fig.cap='Zadolzenost evropskih drzav, Japonske in ZDA leta 2011', fig.align='center'}
print(dvanajsti_graf)
```



```{r zem1, echo=FALSE, warning=FALSE, fig.cap='Zadolzenost evropskih drzav leta 2014', fig.align='center'}
print(zem1)
```


***

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE}
source("analiza/analiza.r", encoding = "UTF-8")
```



